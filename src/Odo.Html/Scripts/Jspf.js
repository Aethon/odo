// Jspf.js
(function(){function executeScript(){
Type.registerNamespace('Jspf');Jspf.IScrollableAxis=function(){};Jspf.IScrollableAxis.registerInterface('Jspf.IScrollableAxis');Jspf.IListItem=function(){};Jspf.IListItem.registerInterface('Jspf.IListItem');Jspf.IItemContainerGenerator=function(){};Jspf.IItemContainerGenerator.registerInterface('Jspf.IItemContainerGenerator');Jspf.Axis=function(){this.length=-1;this.minLength=-1;this.maxLength=-1;this.alignment=0;}
Jspf.Axis.prototype={nearMargin:0,farMargin:0,effectiveMaxLength:function(){return (this.maxLength<0)?Constants.maX_INT:this.maxLength;},effectiveMinLength:function(){return Math.max(this.minLength,0);},effectiveLength:function(){return Math.min(this.effectiveMaxLength(),Math.max(this.effectiveMinLength(),this.length));}}
Jspf.AxisArrangement=function(position,length){this.position=position;this.length=length;}
Jspf.AxisArrangement.prototype={position:0,length:0,clone:function(){return new Jspf.AxisArrangement(this.position,this.length);}}
Constants=function(){}
Jspf.Container=function(){Jspf.Container.initializeBase(this);}
Jspf.Container.prototype={get_child:function(){return this.$4;},set_child:function(value){if(this.$4!=null){this.$4.$2(null);}this.$4=value;if(this.$4!=null){this.$4.$2(this);}return value;},$4:null}
Jspf.ScrollBar=function(){Jspf.ScrollBar.initializeBase(this);this.$1C=ss.Delegate.create(this,this.$1D);this.$18=ss.Delegate.create(this,this.$19);}
Jspf.ScrollBar.prototype={get_scrollableAxis:function(){return this.$4;},set_scrollableAxis:function(value){this.$4=value;this.$4.add_changed(ss.Delegate.create(this,this.$13));return value;},$4:null,get_inputSource:function(){return this.$5[0];},set_inputSource:function(value){this.$5=$(value);this.$5.bind('mousewheel',ss.Delegate.create(this,this.$1A));return value;},$5:null,$6:400,$7:40,$8:false,$9:false,$A:null,$B:null,$C:null,$D:null,$E:null,$F:10,$10:0,$11:0,$12:false,show:function(show){if(this.$A!=null){if(show){this.$A.css('visibility','visible');}else{this.$A.css('visibility','hidden');}}},arrange:function(horizontal,vertical,hostElement){Jspf.ScrollBar.callBaseMethod(this, 'arrange',[horizontal,vertical,hostElement]);if(this.$A==null){this.$A=$('<div class=\'ui-vertical-scrollbar\' style=\'position: absolute;\'></div>').appendTo(hostElement);this.$B=$('<div class=\'ui-scroll-up-button\'></div>').appendTo(this.$A).mousedown(ss.Delegate.create(this,this.$14));this.$D=$('<div class=\'ui-scroll-vertical-track\'></div>').appendTo(this.$A).mousedown(ss.Delegate.create(this,this.$16));this.$E=$('<div class=\'ui-scroll-vertical-thumb\' style=\'position: relative\'></div>').appendTo(this.$D).mousedown(ss.Delegate.create(this,this.$17));this.$C=$('<div class=\'ui-scroll-down-button\'></div>').appendTo(this.$A).mousedown(ss.Delegate.create(this,this.$15));}var $0=(vertical.length>2*horizontal.length)?horizontal.length:Math.floor(vertical.length/2);var $1=vertical.length-2*$0;this.$F=Math.min($0,$1);this.$A.css('width',horizontal.length+'px').css('height',vertical.length+'px').css('top',vertical.position+'px').css('left',horizontal.position+'px');this.$B.css('width',horizontal.length+'px').css('height',$0+'px');this.$C.css('width',horizontal.length+'px').css('height',$0+'px');this.$D.css('width',horizontal.length+'px').css('height',$1+'px');this.$E.css('width',horizontal.length+'px');this.$13();},$13:function(){if(!this.$8){var $0=this.$4.getExtentLength()-this.$4.getViewportLength();var $1=Math.max(Math.floor(this.$D.height()/this.$4.getExtentLength()*this.$4.getViewportLength()),this.$F);var $2=this.$D.height()-$1;var $3=0;if($0>0&&$2>0){var $4=$2/$0;$3=Math.round(this.$4.getViewportPos()*$4);}else{}this.$E.css('top',$3+'px').css('height',$1+'px');}},$14:function($p0){if(!this.$12){this.$1B(ss.Delegate.create(this.$4,this.$4.moveLineNear));}$p0.preventDefault();$p0.stopPropagation();},$15:function($p0){if(!this.$12){this.$1B(ss.Delegate.create(this.$4,this.$4.moveLineFar));}$p0.preventDefault();$p0.stopPropagation();},$16:function($p0){if(!this.$12){var $0=$p0.pageY;var $1=this.$E.offset().top;if($0<=$1){this.$1B(ss.Delegate.create(this.$4,this.$4.movePageNear));}else{this.$1B(ss.Delegate.create(this.$4,this.$4.movePageFar));}}$p0.preventDefault();$p0.stopPropagation();},$17:function($p0){if(!this.$12){this.$8=true;var $0=$p0.pageY;this.$11=$0-this.$E.offset().top;$(document).mousemove(this.$18);$(document).mouseup(this.$1C);}$p0.preventDefault();$p0.stopPropagation();},$18:null,$19:function($p0){if(!this.$12){var $0=($p0.pageY-this.$11);var $1=$0-this.$D.offset().top;var $2=this.$D.height();var $3=this.$4.getExtentLength();this.$4.moveToPos($1*$3/$2);$0=Math.max(0,Math.min($2-this.$E.height(),$1));this.$E.css('top',$0+'px');}},$1A:function($p0){var $0=$p0;if($0.wheelDelta>=120){this.$4.movePageNear();}else if($0.wheelDelta<=-120){this.$4.movePageFar();}$p0.stopPropagation();$p0.preventDefault();},$1B:function($p0){$p0.invoke();this.$10=window.setInterval(ss.Delegate.create(this,function(){
if(this.$10>0){window.clearInterval(this.$10);this.$10=window.setInterval(ss.Delegate.create(this,function(){
$p0.invoke();}),this.$7);$p0.invoke();}}),this.$6);$(document).mouseup(this.$1C);},$1C:null,$1D:function($p0){$(document).unbind('mouseup',this.$1C);$(document).unbind('mousemove',this.$18);if(this.$8){this.$8=false;this.$13();}if(this.$10>0){window.clearInterval(this.$10);}}}
Jspf.Jspf$1=function(item,container){this.$0=container;this.$1=item;}
Jspf.Jspf$1.prototype={$0:null,$1:null}
Jspf.OldListItemContainerGenerator=function(){this.$0=[];}
Jspf.OldListItemContainerGenerator.prototype={get_comparer:function(){return this.$1;},set_comparer:function(value){this.$1=value;return value;},$1:null,get_allItems:function(){return this.$2;},set_allItems:function(value){this.$2=value;if(this.$2!=null){(this.$2).subscribe(ss.Delegate.create(this,function(){
if(this.$4!=null){this.$4.invoke();}}));}return value;},$2:null,count:function(){return (this.$2==null)?0:this.$2.invoke().length;},get_itemTemplate:function(){return this.$3;},set_itemTemplate:function(value){this.$3=value;return value;},$3:null,generateContainer:function(index){var $0=this.getContainerForIndex(index);if($0==null){var $1=this.$2.invoke()[index];$0=this.$3.invoke($1);this.$0.add(new Jspf.Jspf$1($1,$0));}return $0;},getContainerForIndex:function(index){var $0=this.$2.invoke()[index];return this.getContainerForItem($0);},getContainerForItem:function(item){for(var $0=this.$0.length-1;$0>=0;$0--){var $1=this.$0[$0];if($1.$1===item){return $1.$0;}}return null;},getItemForContainer:function(container){for(var $0=this.$0.length-1;$0>=0;$0--){var $1=this.$0[$0];if($1.$0===container){return $1.$1;}}return null;},getIndexForContainer:function(container){var $0=this.getItemForContainer(container);if($0==null){return -1;}return (this.$2.invoke()).binarySearch($0,this.$1);},releaseContainer:function(container){for(var $0=this.$0.length-1;$0>=0;$0--){if((this.$0[$0]).$0===container){this.$0.removeAt($0);break;}}},add_changed:function(value){this.$4=ss.Delegate.combine(this.$4,value);},remove_changed:function(value){this.$4=ss.Delegate.remove(this.$4,value);},$4:null,getActiveItems:function(){return $.map(this.$0,ss.Delegate.create(this,function($p1_0,$p1_1){
return ($p1_0).$1;}));}}
Jspf.ValueSubject=function(){}
Jspf.VirtualStackPanel=function(){this.$8=-1;this.$A=-1;this.$C=-1;this.$D=-1;this.$E=[];Jspf.VirtualStackPanel.initializeBase(this);}
Jspf.VirtualStackPanel.prototype={get_itemContainerGenerator:function(){return this.$4;},set_itemContainerGenerator:function(value){this.$4=value;if(this.$4!=null){this.$4.add_changed(ss.Delegate.create(this,function(){
this.$13(true);}));}this.$13(true);return value;},$4:null,get_fixedItemHeight:function(){return this.$5;},set_fixedItemHeight:function(value){this.$5=value;this.$13(true);return value;},$5:15,get_focusElement:function(){return this.$6;},set_focusElement:function(value){this.$6=value;return value;},$6:null,$7:0,$9:null,$B:0,$F:null,$10:null,$11:null,$12:function(){return (this.$4!=null)?this.$4.count():0;},$13:function($p0){var $0=this.$12();var $1=false;if(this.$F!=null){if($p0||($0===0)){if(this.$4!=null){this.$7=this.$4.getIndexForContainer(this.$9);if(this.$7<0){this.$7=this.$8;}}for(var $2=Math.max(this.$C,0);$2<=this.$D;$2++){this.$15($2);$1=true;}this.$8=-1;this.$9=null;this.$A=-1;this.$C=-1;this.$D=-1;}if($0>0){this.$10.height($0*this.$5);this.$7=Math.max(0,Math.min(this.$7,this.$12()));if(this.$7!==this.$8){$1=true;}var $3=this.$7;var $4=this.$F.innerHeight();var $5=$4/this.$5;var $6=Math.floor($5);var $7=$3+$6-1;if($7>$0-1){var $C=$7-$0+1;$3=Math.max($3-$C,0);$7=$0-1;}var $8=$3-2;var $9=$7+2;this.$8=$3;this.$7=this.$8;this.$9=this.$4.getContainerForIndex(this.$8);this.$A=$7;if($5-$6>0){$7=Math.min($7+1,$0-1);}this.$14((this.$8>0)||(this.$B<$0));var $A=this.$10.innerWidth();for(var $D=$3;$D<=$7;$D++){if(this.$E[$D]==null){$1=true;var $E=this.$4.generateContainer($D);this.$E[$D]=$E;$E.$2(this);$E.measure(new Jspf.Size($A,this.$5));var $F=this.arrangeAxis($E.get_vertical(),$E.measuredSize.height,this.$5);$F.position+=$D*this.$5;$E.arrange(this.arrangeAxis($E.get_horizontal(),$E.measuredSize.width,this.$10.innerWidth()),$F,this.$10[0]);}}this.$10.css('top',(-$3*this.$5)+'px');var $B=false;for(var $10=Math.max(this.$C,0);$10<$8;$10++){this.$15($10);$B=true;}for(var $11=$9+1;$11<=this.$D;$11++){this.$15($11);$B=true;}this.$C=Math.min($3,Math.max($8,this.$C));this.$D=Math.max($7,Math.min($9,this.$D));if($B&&!ss.isNull(this.get_focusElement())){try{this.get_focusElement().focus();}catch($12){}}}else{this.$14(false);}}if($1&&this.$19!=null){this.$19.invoke();}},$14:function($p0){this.$11.show($p0);},$15:function($p0){var $0=this.$E[$p0];if($0!=null){this.$E[$p0]=null;$0.$2(null);this.$4.releaseContainer($0);}},arrange:function(horizontal,vertical,hostElement){Jspf.VirtualStackPanel.callBaseMethod(this, 'arrange',[horizontal,vertical,hostElement]);var $0=18;if(this.$F==null){this.$F=$('<div style=\'overflow: hidden; -khtml-user-select: none; -moz-user-select: none; position: absolute\'></div>').appendTo(hostElement);this.$10=$('<div style=\'overflow: hidden; -khtml-user-select: none; -moz-user-select: none; position: absolute\'></div>').appendTo(this.$F);this.$11=new Jspf.ScrollBar();this.$11.set_scrollableAxis(this);this.$11.set_inputSource(this.$F[0]);}this.$10.width(horizontal.length).height(this.$12()*this.$5);this.$F.width(horizontal.length).height(vertical.length).css('top',vertical.position+'px').css('left',horizontal.position+'px');this.$B=Math.floor(this.$F.innerHeight()/this.$5);var $1=horizontal.clone();$1.position=$1.position+$1.length-$0;$1.length=$0;this.$11.arrange($1,vertical,this.$F[0]);this.$13(true);},$16:false,$17:function(){this.$16=true;window.setTimeout(ss.Delegate.create(this,this.$18),10);},$18:function(){if(this.$16){this.$16=false;this.$13(false);}},getExtentLength:function(){return this.$12();},getViewportPos:function(){return this.$8;},getViewportLength:function(){return this.$B;},add_changed:function(value){this.$19=ss.Delegate.combine(this.$19,value);},remove_changed:function(value){this.$19=ss.Delegate.remove(this.$19,value);},$19:null,moveLineNear:function(){this.$7=this.$7-1;this.$17();},moveLineFar:function(){this.$7=this.$7+1;this.$17();},movePageNear:function(){this.$7=this.$7-10;this.$17();},movePageFar:function(){this.$7=this.$7+10;this.$17();},moveToPos:function(position){this.$7=Math.floor(position);this.$17();},scrollIntoViewport:function(line){if(line<this.$8){this.$7=line;this.$17();}if(line>this.$A){this.$7=line-this.getViewportLength()+1;this.$17();}}}
Jspf.Jspf$0=function(selected,index){this.$0=selected;this.$1=index;}
Jspf.Jspf$0.prototype={$0:null,$1:0,get_isSelected:function(){return this.$0.contains(this.$2);},set_isSelected:function($p0){this.$0[this.$1]=$p0;return $p0;},get_isEnabled:function(){return true;},set_isEnabled:function($p0){return $p0;},get_data:function(){return this.$2;},set_data:function($p0){this.$2=$p0;return $p0;},$2:null}
Jspf.ListBox=function(){this.$6=Jspf.ListBox.$A;this.$7=Jspf.ListBox.$A;this.$E=[];this.$F=[];Jspf.ListBox.initializeBase(this);}
Jspf.ListBox.$A=function($p0){var $0=new Jspf.DomControl();$0.set_domContent($('<div style=\'height: 12px\'>'+$p0+'</div>')[0]);return $0;}
Jspf.ListBox.isScrolledIntoView=function(host,subject){var $0=host.offset().top;var $1=$0+host.height();var $2=subject.offset().top;var $3=$2+subject.height();return (($3>=$0)&&($2<=$1)&&($3<=$1)&&($2>=$0));}
Jspf.ListBox.prototype={get_itemContainerGenerator:function(){return this.$4;},set_itemContainerGenerator:function(value){this.$4=value;return value;},$4:null,get_fixedItemHeight:function(){return this.$5;},set_fixedItemHeight:function(value){this.$5=value;return value;},$5:14,get_itemTemplate:function(){return this.$6;},set_itemTemplate:function(value){this.$6=value||Jspf.ListBox.$A;return value;},get_itemContainerTemplate:function(){return this.$7;},set_itemContainerTemplate:function(value){this.$7=value||Jspf.ListBox.$A;return value;},$8:null,$9:function(){return (this.$4!=null)?this.$4.count():0;},measure:function(size){if(this.$8==null){this.$8=new Jspf.VirtualStackPanel();this.$8.$2(this);this.$8.set_horizontal(this.get_horizontal());this.$8.set_vertical(this.get_vertical());this.$8.set_fixedItemHeight(this.get_fixedItemHeight());this.$8.set_itemContainerGenerator(this.get_itemContainerGenerator());}this.$8.measure(size);this.measuredSize=this.$8.measuredSize;},arrange:function(horizontal,vertical,hostElement){Jspf.ListBox.callBaseMethod(this, 'arrange',[horizontal,vertical,hostElement]);if(this.$8!=null){this.$8.arrange(horizontal,vertical,hostElement);}},$B:0,$C:0,$D:function($p0){this.$B=$p0;},get_source:function(){return this.$E;},set_source:function(value){this.$E=value||[];return value;},get_selected:function(){return this.$F;},set_selected:function(value){this.$F=value||[];return value;},get_focus:function(){return this.$10;},set_focus:function(value){return value;},$10:null}
Jspf.Decorator=function(){Jspf.Decorator.initializeBase(this);}
Jspf.Decorator.prototype={get_child:function(){return this.$4;},set_child:function(value){if(this.$4!=null){this.$4.$2(null);}this.$4=value;if(this.$4!=null){this.$4.$2(this);}return value;},$4:null}
Jspf.DomControl=function(){Jspf.DomControl.initializeBase(this);}
Jspf.DomControl.prototype={$4:false,get_domContent:function(){return (this.$5!=null)?this.$5[0]:null;},set_domContent:function(value){if(this.$5!=null){this.$5.remove();this.$5=null;}this.$4=false;if(value!=null){this.$5=$(value);}return value;},$5:null,$2:function($p0){Jspf.DomControl.callBaseMethod(this, '$2',[$p0]);if(($p0==null)&&(this.$5!=null)){this.$5.remove();this.$4=false;}},arrange:function(horizontal,vertical,hostElement){Jspf.DomControl.callBaseMethod(this, 'arrange',[horizontal,vertical,hostElement]);if(this.$5!=null){if(!this.$4){this.$5.appendTo(hostElement);}this.$5.css('position','absolute').css('left',horizontal.position+'px').css('top',vertical.position+'px').css('width',horizontal.length+'px').css('height',vertical.length+'px');}}}
Jspf.Rect=function(){}
Jspf.Rect.prototype={top:0,left:0,width:0,height:0}
Jspf.Region=function(){Jspf.Region.initializeBase(this);}
Jspf.Region.getRegion=function(descendant){while(descendant!=null&&!(Type.canCast(descendant,Jspf.Region))){descendant=descendant.getParent();}return descendant;}
Jspf.Region.prototype={host:null,layOut:function(){var $0;if(this.host==null||this.host.tagName!=='DIV'){throw new Error('Host must be a div element');}var $1=$(this.host);$1.css('padding','0px');var $2=$1.innerWidth();var $3=$1.innerHeight();if($2===0&&$3===0){$2=parseInt($1.css('width'));$3=parseInt($1.css('height'));}$0=new Jspf.Size($2,$3);if(this.get_child()!=null){this.get_child().measure($0);var $4=this.arrangeAxis(this.get_child().get_horizontal(),this.get_child().measuredSize.width,$0.width);var $5=this.arrangeAxis(this.get_child().get_vertical(),this.get_child().measuredSize.height,$0.height);this.get_child().arrange($4,$5,this.host);}},measure:function(size){this.measuredSize=size.clone();},arrange:function(horizontal,vertical,hostElement){}}
Jspf.Size=function(width,height){this.width=width;this.height=height;}
Jspf.Size.prototype={width:0,height:0,clone:function(){return new Jspf.Size(this.width,this.height);}}
Jspf.Control=function(){this.$0=new Jspf.Axis();this.$1=new Jspf.Axis();}
Jspf.Control.prototype={get_horizontal:function(){return this.$0;},set_horizontal:function(value){this.$0=value||new Jspf.Axis();return value;},get_vertical:function(){return this.$1;},set_vertical:function(value){this.$1=value||new Jspf.Axis();return value;},measuredSize:null,verticalArrangement:null,horizontalArrangement:null,getParent:function(){return this.$3;},$2:function($p0){this.$3=$p0;},$3:null,measure:function(size){var $0=this.get_horizontal().effectiveLength();var $1=this.get_vertical().effectiveLength();this.measuredSize=new Jspf.Size($0,$1);},arrange:function(horizontal,vertical,hostElement){this.verticalArrangement=vertical.clone();this.horizontalArrangement=horizontal.clone();},arrangeAxis:function(axis,measured,available){var $0=0;var $1=0;var $2=0;if(axis.alignment===0){$0=Math.min(available,axis.effectiveMaxLength());}else{$0=Math.min(available,measured);}$0=Math.max(axis.effectiveMinLength(),$0-axis.nearMargin-axis.farMargin);switch(axis.alignment){case -1:$1=axis.nearMargin;break;case 1:$1=available-axis.farMargin-$0;break;case 2:case 0:$2=axis.farMargin+axis.nearMargin+$0;if($2!==available){$1=Math.floor((available-$2)/2);}break;default:throw new Error('Unknown axis alignment specified');}return new Jspf.AxisArrangement($1,$0);}}
Jspf.Axis.registerClass('Jspf.Axis');Jspf.AxisArrangement.registerClass('Jspf.AxisArrangement');Constants.registerClass('Constants');Jspf.Control.registerClass('Jspf.Control');Jspf.Container.registerClass('Jspf.Container',Jspf.Control);Jspf.ScrollBar.registerClass('Jspf.ScrollBar',Jspf.Control);Jspf.Jspf$1.registerClass('Jspf.Jspf$1');Jspf.OldListItemContainerGenerator.registerClass('Jspf.OldListItemContainerGenerator',null,Jspf.IItemContainerGenerator);Jspf.ValueSubject.registerClass('Jspf.ValueSubject');Jspf.VirtualStackPanel.registerClass('Jspf.VirtualStackPanel',Jspf.Control,Jspf.IScrollableAxis);Jspf.Jspf$0.registerClass('Jspf.Jspf$0',null,Jspf.IListItem);Jspf.ListBox.registerClass('Jspf.ListBox',Jspf.Control);Jspf.Decorator.registerClass('Jspf.Decorator',Jspf.Control);Jspf.DomControl.registerClass('Jspf.DomControl',Jspf.Control);Jspf.Rect.registerClass('Jspf.Rect');Jspf.Region.registerClass('Jspf.Region',Jspf.Decorator);Jspf.Size.registerClass('Jspf.Size');Constants.maX_INT=Math.pow(2,31)-1;}
ss.loader.registerScript('Jspf',[],executeScript);})();// This script was generated using Script# v0.6.3.0
